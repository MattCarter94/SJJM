<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>NBGardens - Products</title>
        
    </h:head>
    <body>
        <ui:composition template="templates/template.xhtml">
        	<ui:define name="content">
        		<script type="application/javascript" src="https://code.jquery.com/jquery-1.12.4.js"></script>
        		<script type="application/javascript" src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
   				<script src="js/products.js"></script>
        		<link rel="stylesheet" href="css/products.css"/>
		        <h1>Products</h1> 
		        <div class="accordion">
		        	<h:button value="+ Product" outcome="AddProduct.xhtml" styleClass="but"></h:button>
		        
		        </div>
		        
                 	
		        
		        <br/><br/>
		        
		        <div class="filter-block">
		        	<h:form id="filter">
			            <h2>Filters</h2>
			            <div class="priceOrder">
			                <h4>Order By: </h4>
			                <select name="filter_order">
			                    <option value="any">Any</option>
			                    <option value="hightolow">High to Low</option>
			                    <option value="lowtohigh">Low to High</option>
			                </select>
			            </div>
			            <div class="typeOrder">
			            	
			                <h4>Category: </h4>
			                <select name="filter_type">
			                    <option value="gnome">Gnome</option>
			                    <option value="gnomeaccesories">Gnome Accessories</option>
			                    <option value="other">Other Products</option>
			                </select>
			            </div>
			            <input id="tagsSearch" type="text" name="filter_search" value="#{search.searchTerms}"/>
			            <br/>
			            <h:commandButton value="Search" >
			            	<f:ajax execute="@this" render="product-list"/>
			            </h:commandButton>
		            </h:form>
		        </div>
		        
		        
		     
		        <div class="product-list">
		        	<h:outputText escape="false" value="No Products Found" rendered="#{products.products.size() == 0 }" />
	           		<ui:repeat var="product" value="#{products.products}">
	           			<li class="product"  style="#{(product.state == 'ACTIVE') ? '' : 'opacity:0.6; filter: alpha(opacity=60)'}">
	            			<div class="accordion">
	                        	<span class="idNumber">##{product.productID}</span><span class="title">#{product.title}</span> <span class="price"> Â£#{product.price} </span><button class="orderStockButton">Order Stock</button>
	                        	<div class="stock-bar horizontal">
	                            	<div class="stock-track">
	                                	<div class="stock-fill">
	                                    	<span>#{products.calculateStockLevel(product.productID)}%</span>
	                                	</div>
	                                	<p>#{product.stock}</p>
	                            	</div>
	                        	</div>
	                    	</div>
	                    	<div class="panel">
	                    		<h:form id="details" action="">
		                        	<h3><b>Edit Details</b></h3>
		                        
		                        	<div class="detail">
		                            	<h4>Title:</h4> 
		                            	<input type="text" name="product_title" value="#{product.title}"/>
		                        	</div>
		                        	<div class="detail">
		                            	<h4>Price:</h4> 
		                            	<input type="text" name="product_price" value="#{product.price}"/>
		                        	</div>
		                        	<div class="detail">
		                            	<h4>Description: </h4> 
		                            	<textarea name="product_description" rows="5" cols="50">#{product.description}</textarea>
		                        	</div>
		                        	<div class="detail">
		                            	<h4>Category: </h4> 
		                            	<h:selectOneMenu name="product_category" value="#{product.category}">
		                            		<f:selectItems value="#{products.categoryValues}"/>
		                            	</h:selectOneMenu>
		                        	</div>
		                        	<div class="detail">
		                            	<h4>Image: </h4>
		                            	<input type="text" name="product_image" value="#{product.image}"/>
		                        	</div>
		                        	<div class="detail">
		                            	<h4>Tags: </h4> 
		                            	<textarea class="descriptionDetails" name="product_tags" rows="4" cols="50">#{product.tags}</textarea>
		                        	</div>
		                        	<div class="detail">
		                            	<h4>Stock: </h4> 
		                            	<input type="text" name="product_stock" value="#{product.stock}"/>
		                        	</div>
		                        	<div class="detail">
		                            	<h4>Active: </h4> 
		                            	<h:selectOneMenu class="activeDetails" name="product_active" value="#{product.state}">
		                            		<f:selectItems value="#{products.activeValues}"/>
		                           		</h:selectOneMenu>
		                        	</div>
		                        	<h:commandButton id="saveButton" type="submit" action="#{products.updateProduct(product.productID)}" value="Save Details"/>
		                        </h:form>
	                    	</div>
	            		</li>           	
	            	</ui:repeat>
		        </div>
	        </ui:define>
        </ui:composition>
    </body>
</html>